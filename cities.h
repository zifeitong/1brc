#include <array>
#include <string_view>

#include "mph.h"
#include "o1hash.h"

using std::literals::operator""sv;

static constexpr auto city_names = std::array{
    "Abha"sv,
    "Abidjan"sv,
    "Abéché"sv,
    "Accra"sv,
    "Addis Ababa"sv,
    "Adelaide"sv,
    "Aden"sv,
    "Ahvaz"sv,
    "Albuquerque"sv,
    "Alexandra"sv,
    "Alexandria"sv,
    "Algiers"sv,
    "Alice Springs"sv,
    "Almaty"sv,
    "Amsterdam"sv,
    "Anadyr"sv,
    "Anchorage"sv,
    "Andorra la Vella"sv,
    "Ankara"sv,
    "Antananarivo"sv,
    "Antsiranana"sv,
    "Arkhangelsk"sv,
    "Ashgabat"sv,
    "Asmara"sv,
    "Assab"sv,
    "Astana"sv,
    "Athens"sv,
    "Atlanta"sv,
    "Auckland"sv,
    "Austin"sv,
    "Baghdad"sv,
    "Baguio"sv,
    "Baku"sv,
    "Baltimore"sv,
    "Bamako"sv,
    "Bangkok"sv,
    "Bangui"sv,
    "Banjul"sv,
    "Barcelona"sv,
    "Bata"sv,
    "Batumi"sv,
    "Beijing"sv,
    "Beirut"sv,
    "Belgrade"sv,
    "Belize City"sv,
    "Benghazi"sv,
    "Bergen"sv,
    "Berlin"sv,
    "Bilbao"sv,
    "Birao"sv,
    "Bishkek"sv,
    "Bissau"sv,
    "Blantyre"sv,
    "Bloemfontein"sv,
    "Boise"sv,
    "Bordeaux"sv,
    "Bosaso"sv,
    "Boston"sv,
    "Bouaké"sv,
    "Bratislava"sv,
    "Brazzaville"sv,
    "Bridgetown"sv,
    "Brisbane"sv,
    "Brussels"sv,
    "Bucharest"sv,
    "Budapest"sv,
    "Bujumbura"sv,
    "Bulawayo"sv,
    "Burnie"sv,
    "Busan"sv,
    "Cabo San Lucas"sv,
    "Cairns"sv,
    "Cairo"sv,
    "Calgary"sv,
    "Canberra"sv,
    "Cape Town"sv,
    "Changsha"sv,
    "Charlotte"sv,
    "Chiang Mai"sv,
    "Chicago"sv,
    "Chihuahua"sv,
    "Chittagong"sv,
    "Chișinău"sv,
    "Chongqing"sv,
    "Christchurch"sv,
    "City of San Marino"sv,
    "Colombo"sv,
    "Columbus"sv,
    "Conakry"sv,
    "Copenhagen"sv,
    "Cotonou"sv,
    "Cracow"sv,
    "Da Lat"sv,
    "Da Nang"sv,
    "Dakar"sv,
    "Dallas"sv,
    "Damascus"sv,
    "Dampier"sv,
    "Dar es Salaam"sv,
    "Darwin"sv,
    "Denpasar"sv,
    "Denver"sv,
    "Detroit"sv,
    "Dhaka"sv,
    "Dikson"sv,
    "Dili"sv,
    "Djibouti"sv,
    "Dodoma"sv,
    "Dolisie"sv,
    "Douala"sv,
    "Dubai"sv,
    "Dublin"sv,
    "Dunedin"sv,
    "Durban"sv,
    "Dushanbe"sv,
    "Edinburgh"sv,
    "Edmonton"sv,
    "El Paso"sv,
    "Entebbe"sv,
    "Erbil"sv,
    "Erzurum"sv,
    "Fairbanks"sv,
    "Fianarantsoa"sv,
    "Flores,  Petén"sv,
    "Frankfurt"sv,
    "Fresno"sv,
    "Fukuoka"sv,
    "Gaborone"sv,
    "Gabès"sv,
    "Gagnoa"sv,
    "Gangtok"sv,
    "Garissa"sv,
    "Garoua"sv,
    "George Town"sv,
    "Ghanzi"sv,
    "Gjoa Haven"sv,
    "Guadalajara"sv,
    "Guangzhou"sv,
    "Guatemala City"sv,
    "Halifax"sv,
    "Hamburg"sv,
    "Hamilton"sv,
    "Hanga Roa"sv,
    "Hanoi"sv,
    "Harare"sv,
    "Harbin"sv,
    "Hargeisa"sv,
    "Hat Yai"sv,
    "Havana"sv,
    "Helsinki"sv,
    "Heraklion"sv,
    "Hiroshima"sv,
    "Ho Chi Minh City"sv,
    "Hobart"sv,
    "Hong Kong"sv,
    "Honiara"sv,
    "Honolulu"sv,
    "Houston"sv,
    "Ifrane"sv,
    "Indianapolis"sv,
    "Iqaluit"sv,
    "Irkutsk"sv,
    "Istanbul"sv,
    "Jacksonville"sv,
    "Jakarta"sv,
    "Jayapura"sv,
    "Jerusalem"sv,
    "Johannesburg"sv,
    "Jos"sv,
    "Juba"sv,
    "Kabul"sv,
    "Kampala"sv,
    "Kandi"sv,
    "Kankan"sv,
    "Kano"sv,
    "Kansas City"sv,
    "Karachi"sv,
    "Karonga"sv,
    "Kathmandu"sv,
    "Khartoum"sv,
    "Kingston"sv,
    "Kinshasa"sv,
    "Kolkata"sv,
    "Kuala Lumpur"sv,
    "Kumasi"sv,
    "Kunming"sv,
    "Kuopio"sv,
    "Kuwait City"sv,
    "Kyiv"sv,
    "Kyoto"sv,
    "La Ceiba"sv,
    "La Paz"sv,
    "Lagos"sv,
    "Lahore"sv,
    "Lake Havasu City"sv,
    "Lake Tekapo"sv,
    "Las Palmas de Gran Canaria"sv,
    "Las Vegas"sv,
    "Launceston"sv,
    "Lhasa"sv,
    "Libreville"sv,
    "Lisbon"sv,
    "Livingstone"sv,
    "Ljubljana"sv,
    "Lodwar"sv,
    "Lomé"sv,
    "London"sv,
    "Los Angeles"sv,
    "Louisville"sv,
    "Luanda"sv,
    "Lubumbashi"sv,
    "Lusaka"sv,
    "Luxembourg City"sv,
    "Lviv"sv,
    "Lyon"sv,
    "Madrid"sv,
    "Mahajanga"sv,
    "Makassar"sv,
    "Makurdi"sv,
    "Malabo"sv,
    "Malé"sv,
    "Managua"sv,
    "Manama"sv,
    "Mandalay"sv,
    "Mango"sv,
    "Manila"sv,
    "Maputo"sv,
    "Marrakesh"sv,
    "Marseille"sv,
    "Maun"sv,
    "Medan"sv,
    "Mek'ele"sv,
    "Melbourne"sv,
    "Memphis"sv,
    "Mexicali"sv,
    "Mexico City"sv,
    "Miami"sv,
    "Milan"sv,
    "Milwaukee"sv,
    "Minneapolis"sv,
    "Minsk"sv,
    "Mogadishu"sv,
    "Mombasa"sv,
    "Monaco"sv,
    "Moncton"sv,
    "Monterrey"sv,
    "Montreal"sv,
    "Moscow"sv,
    "Mumbai"sv,
    "Murmansk"sv,
    "Muscat"sv,
    "Mzuzu"sv,
    "N'Djamena"sv,
    "Naha"sv,
    "Nairobi"sv,
    "Nakhon Ratchasima"sv,
    "Napier"sv,
    "Napoli"sv,
    "Nashville"sv,
    "Nassau"sv,
    "Ndola"sv,
    "New Delhi"sv,
    "New Orleans"sv,
    "New York City"sv,
    "Ngaoundéré"sv,
    "Niamey"sv,
    "Nicosia"sv,
    "Niigata"sv,
    "Nouadhibou"sv,
    "Nouakchott"sv,
    "Novosibirsk"sv,
    "Nuuk"sv,
    "Odesa"sv,
    "Odienné"sv,
    "Oklahoma City"sv,
    "Omaha"sv,
    "Oranjestad"sv,
    "Oslo"sv,
    "Ottawa"sv,
    "Ouagadougou"sv,
    "Ouahigouya"sv,
    "Ouarzazate"sv,
    "Oulu"sv,
    "Palembang"sv,
    "Palermo"sv,
    "Palm Springs"sv,
    "Palmerston North"sv,
    "Panama City"sv,
    "Parakou"sv,
    "Paris"sv,
    "Perth"sv,
    "Petropavlovsk-Kamchatsky"sv,
    "Philadelphia"sv,
    "Phnom Penh"sv,
    "Phoenix"sv,
    "Pittsburgh"sv,
    "Podgorica"sv,
    "Pointe-Noire"sv,
    "Pontianak"sv,
    "Port Moresby"sv,
    "Port Sudan"sv,
    "Port Vila"sv,
    "Port-Gentil"sv,
    "Portland (OR)"sv,
    "Porto"sv,
    "Prague"sv,
    "Praia"sv,
    "Pretoria"sv,
    "Pyongyang"sv,
    "Rabat"sv,
    "Rangpur"sv,
    "Reggane"sv,
    "Reykjavík"sv,
    "Riga"sv,
    "Riyadh"sv,
    "Rome"sv,
    "Roseau"sv,
    "Rostov-on-Don"sv,
    "Sacramento"sv,
    "Saint Petersburg"sv,
    "Saint-Pierre"sv,
    "Salt Lake City"sv,
    "San Antonio"sv,
    "San Diego"sv,
    "San Francisco"sv,
    "San Jose"sv,
    "San José"sv,
    "San Juan"sv,
    "San Salvador"sv,
    "Sana'a"sv,
    "Santo Domingo"sv,
    "Sapporo"sv,
    "Sarajevo"sv,
    "Saskatoon"sv,
    "Seattle"sv,
    "Seoul"sv,
    "Seville"sv,
    "Shanghai"sv,
    "Singapore"sv,
    "Skopje"sv,
    "Sochi"sv,
    "Sofia"sv,
    "Sokoto"sv,
    "Split"sv,
    "St. John's"sv,
    "St. Louis"sv,
    "Stockholm"sv,
    "Surabaya"sv,
    "Suva"sv,
    "Suwałki"sv,
    "Sydney"sv,
    "Ségou"sv,
    "Tabora"sv,
    "Tabriz"sv,
    "Taipei"sv,
    "Tallinn"sv,
    "Tamale"sv,
    "Tamanrasset"sv,
    "Tampa"sv,
    "Tashkent"sv,
    "Tauranga"sv,
    "Tbilisi"sv,
    "Tegucigalpa"sv,
    "Tehran"sv,
    "Tel Aviv"sv,
    "Thessaloniki"sv,
    "Thiès"sv,
    "Tijuana"sv,
    "Timbuktu"sv,
    "Tirana"sv,
    "Toamasina"sv,
    "Tokyo"sv,
    "Toliara"sv,
    "Toluca"sv,
    "Toronto"sv,
    "Tripoli"sv,
    "Tromsø"sv,
    "Tucson"sv,
    "Tunis"sv,
    "Ulaanbaatar"sv,
    "Upington"sv,
    "Vaduz"sv,
    "Valencia"sv,
    "Valletta"sv,
    "Vancouver"sv,
    "Veracruz"sv,
    "Vienna"sv,
    "Vientiane"sv,
    "Villahermosa"sv,
    "Vilnius"sv,
    "Virginia Beach"sv,
    "Vladivostok"sv,
    "Warsaw"sv,
    "Washington, D.C."sv,
    "Wau"sv,
    "Wellington"sv,
    "Whitehorse"sv,
    "Wichita"sv,
    "Willemstad"sv,
    "Winnipeg"sv,
    "Wrocław"sv,
    "Xi'an"sv,
    "Yakutsk"sv,
    "Yangon"sv,
    "Yaoundé"sv,
    "Yellowknife"sv,
    "Yerevan"sv,
    "Yinchuan"sv,
    "Zagreb"sv,
    "Zanzibar City"sv,
    "Zürich"sv,
    "Ürümqi"sv,
    "İzmir"sv,
};

static constexpr auto _table = std::array{
    1243646474u, 1469753018u, 571426518u,  1588031554u, 865479793u,
    1448844194u, 1597412512u, 1404205670u, 1455132701u, 1575857380u,
    1433581769u, 1467801159u, 1581326480u, 1669439056u, 1693074706u,
    1709288654u, 1543364439u, 1333220702u, 1460727372u, 1333989414u,
    1359549794u, 1436157429u, 1417077769u, 1460786901u, 1250688056u,
    1409787902u, 1568814788u, 1409731366u, 1326876171u, 1567870533u,
    1347547513u, 1581422564u, 1807132641u, 1562222162u, 1469715644u,
    1484252851u, 1607237743u, 1653568273u, 1398591798u, 1244843320u,
    1598843637u, 1449704836u, 1777010393u, 1308009217u, 481691902u,
    1333618238u, 1421118756u, 1512103819u, 1339007949u, 1333631600u,
    1491210362u, 1486989366u, 1686077164u, 1533237729u, 1640269356u,
    1410028593u, 1579627880u, 1657247192u, 78973202u,   1519875415u,
    1736318134u, 1608609322u, 1383934866u, 1535064495u, 1655420121u,
    1421609234u, 1385984110u, 1334345906u, 1463850905u, 1327327235u,
    481967851u,  1663661484u, 1693505842u, 1435451541u, 1468510532u,
    1168302434u, 1571529084u, 1576085849u, 430654891u,  1345518067u,
    1289355832u, 1489471631u, 448099502u,  1589465617u, 1435526657u,
    1684668442u, 1597967881u, 1502217533u, 1540311296u, 1352298636u,
    1656590378u, 1597341359u, 1227514251u, 1157791791u, 1352233116u,
    1428931714u, 1387504885u, 1567363654u, 772645509u,  1588751303u,
    1715057327u, 1548176315u, 1686202107u, 1441236300u, 1649654212u,
    1456748677u, 1569004239u, 1497643193u, 1564426793u, 1384215811u,
    1294086295u, 1511670198u, 1393836182u, 1332777778u, 1488992727u,
    1652558523u, 1692911527u, 1221785432u, 1308008161u, 1476579764u,
    1702295561u, 1466827996u, 1503320533u, 473919538u,  1522507437u,
    1641892802u, 1569306513u, 1554361365u, 608785074u,  1517798983u,
    1608627967u, 1534644598u, 1607787582u, 477491334u,  1731974884u,
    1325021000u, 1263076602u, 1827509489u, 1518516751u, 1515518607u,
    1553001228u, 1647016677u, 426255253u,  1583722178u, 1490916417u,
    1442477241u, 1387647991u, 805095214u,  1409842810u, 1598010638u,
    1477080502u, 1429806353u, 1364559592u, 1602886854u, 1018487908u,
    1295170765u, 1761147515u, 1723963554u, 1438665181u, 1626216676u,
    1729881754u, 1716266190u, 1328303276u, 1620696322u, 1460786382u,
    1500207752u, 1448744310u, 1518987705u, 3403197243u, 1243055488u,
    1737385691u, 1340058551u, 1354700781u, 1390617686u, 1627508717u,
    503782751u,  1321193877u, 1511555843u, 1416492677u, 1634990312u,
    1632170380u, 1358981509u, 1308043219u, 1713011448u, 1534080612u,
    1470731580u, 1546798739u, 465635536u,  1837813387u, 1738965316u,
    1136310239u, 1291486814u, 1656142756u, 1596330650u, 1685283289u,
    1413523165u, 605334974u,  981774182u,  1670531096u, 1609339377u,
    1491575938u, 1524804437u, 1564763308u, 1366245834u, 1493238557u,
    1398465897u, 1539369067u, 1002171695u, 1429888124u, 1367532304u,
    1421904664u, 1371361812u, 1672199771u, 1837811968u, 1598552463u,
    1484416949u, 1243722204u, 1602517294u, 1671347901u, 1346280776u,
    1398383446u, 1320407572u, 1396816690u, 1575488902u, 1456252949u,
    1441257658u, 1746973278u, 1540447483u, 1497977875u, 1599220448u,
    1326148838u, 933679829u,  1538128213u, 1559450347u, 1346016420u,
    482367134u,  1539819781u, 1326775882u, 1698691264u, 1663326661u,
    1686082719u, 1483701996u, 1250131677u, 1360043341u, 1600786051u,
    1783012169u, 1494647226u, 1597858251u, 1300741136u, 1569018794u,
    1377533639u, 1925608333u, 1460177184u, 1243646104u, 1605343936u,
    1539504068u, 1461052461u, 1541115649u, 1422918792u, 1486988584u,
    1462915144u, 915013291u,  1051130332u, 1083858251u, 321974085u,
    1534004524u, 1579606289u, 1282223552u, 1484487484u, 1463424420u,
    1411888395u, 1513540583u, 1609674633u, 109825490u,  1397539206u,
    1380370332u, 1593904173u, 1627288544u, 1525011556u, 1611998547u,
    1473738233u, 1731073950u, 1807262298u, 1321421013u, 1595757651u,
    1686173740u, 1547942081u, 464496326u,  1512188958u, 1526257580u,
    1685802998u, 702110220u,  1462138097u, 1133533218u, 1605047129u,
    1699048246u, 1505779268u, 1085443493u, 1428813068u, 1783641065u,
    1744074551u, 1207171563u, 1492469186u, 1038409978u, 1739226675u,
    1576069608u, 1400529474u, 1603483592u, 1701594350u, 1364284251u,
    1605088348u, 1307557129u, 1669196818u, 1243549484u, 1327988733u,
    1348407613u, 1396792643u, 1653118628u, 1501209550u, 1421932533u,
    1462207526u, 1581086538u, 1097579894u, 992277892u,  1040377885u,
    976465328u,  1474701124u, 1097750337u, 1139828358u, 502194000u,
    1661359803u, 1635102215u, 1388488272u, 1661841662u, 1662274257u,
    1738531032u, 1469901617u, 1476284725u, 1508922061u, 1491738977u,
    1435257516u, 1400923565u, 1700688263u, 1532669722u, 1008398594u,
    1076544002u, 1429270923u, 1244021972u, 1245050738u, 1738780643u,
    1540791333u, 1614246241u, 1566155128u, 1636394905u, 1447967971u,
    1512074781u, 1412402082u, 1365538483u, 1546302890u, 1468121062u,
    1532593827u, 1477583041u, 1456031580u, 1435562058u, 1168962205u,
    1612449561u, 609089080u,  1372237624u, 1520328998u, 1409729893u,
    1563825023u, 1853220949u, 1295120489u, 1400171894u, 1613249799u,
    1590912048u, 288960898u,  1649425505u, 1525929576u, 1351500556u,
    1684767272u, 1845269407u, 1295673784u, 1570468286u, 1645665159u,
    1648532589u, 1504093708u, 1463956856u, 1543453640u, 1560743458u,
    441044721u,  1518055756u, 1499736500u, 1090785124u, 339970311u,
    1483528499u, 1590663915u, 1394332543u, 1579529474u, 1575272293u,
    1875301442u, 1321382413u, 1716264203u, 1561432704u, 205343586u,
    1477771454u, 1643616391u, 1614384830u, 1414785200u, 1828177129u,
    1514301510u, 322843189u,  1546932180u,
};

int get_index(std::string_view name) {
  return mph::lookup<_table>(o1hash(name.data(), name.size()) >> 32);
}

std::string_view get_name(int index) { return city_names[index]; }
